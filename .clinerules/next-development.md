# Next.js開発ガイドライン

## 目的
- パフォーマンス、セキュリティ、保守性に関するベストプラクティスに厳密に従うNext.jsソリューションを作成する
- バックエンド実装はドメイン駆動設計（DDD）とクリーンアーキテクチャを活用する

## コードスタイルと構造
- 正確な例を含む簡潔な技術的なTypeScriptコードを記述する
- フロントエンドでは関数型および宣言型プログラミングパターンを使用する
- バックエンドドメインモデルを設計する場合は、特にクラスの使用を許容する
- コードの重複よりも反復と分割を優先する
- 補助動詞を含む説明的な変数名を使用する（例：`isLoading`、`hasError`）
- ファイルをエクスポートされたコンポーネント、サブコンポーネント、ヘルパー、静的コンテンツ、および型に明確に構造化する
- ディレクトリ名にはダッシュ付きの小文字を使用する（例：`components/auth-wizard`）

## バックエンドアーキテクチャ
- ドメイン駆動設計（DDD）の原則に従う：
  - ドメインエンティティ、値オブジェクト、集約ルートを明確に定義する
  - インフラストラクチャロジックを抽象化するためのリポジトリとサービスを使用する
- クリーンアーキテクチャに厳密に従う：
  - レイヤー間の明確な境界を維持する（ドメイン、アプリケーション、インターフェース、インフラストラクチャ）
  - 依存関係がドメインレイヤーに向かって内側を指すようにする

## 最適化とベストプラクティス
- `'use client'`、`useEffect`、`setState`の使用を最小限に抑える
- React Server Components（RSC）とNext.jsのSSR機能を優先する
- コード分割と最適化のための動的インポートを実装する
- モバイルファーストアプローチでレスポンシブデザインを使用する
- 画像の最適化：WebP形式の使用、サイズデータの含め、遅延読み込みの実装

## エラー処理と検証
- エラー処理とエッジケースを優先する：
  - エラー条件に対する早期リターンを使用する
  - 前提条件と無効な状態を早期に処理するためのガード句を実装する
  - 一貫したエラー処理のためのカスタムエラータイプを使用する

## UIとスタイリング
- モダンUIフレームワーク（Tailwind CSS、Shadcn UI、Radix UIなど）を使用する
- プラットフォーム間で一貫したデザインとレスポンシブパターンを実装する

## 状態管理とデータ取得
- モダンな状態管理ソリューション（Zustand、TanStack React Queryなど）を使用する
- スキーマ検証にはZodを実装する

## セキュリティとパフォーマンス
- 適切なエラー処理、ユーザー入力検証、セキュアコーディングプラクティスを実装する
- ロード時間の短縮やレンダリング効率の向上などのパフォーマンス最適化テクニックに従う

## テストとドキュメント
- JestとReact Testing Libraryを使用したコンポーネントの単体テストを作成する
- 複雑なロジックには明確で簡潔なコメントを提供する
- IDE intellisenseを改善するためにJSDocコメントを関数とコンポーネントに使用する

## 方法論
1. **System 2 Thinking**：分析的な厳密さで問題にアプローチする。要件を小さく管理しやすい部分に分解し、実装前に各ステップを徹底的に検討する。
2. **Tree of Thoughts**：複数の可能なソリューションとその結果を評価する。構造化されたアプローチを使用して異なるパスを探索し、最適なものを選択する。
3. **Iterative Refinement**：コードを確定する前に、改善点、エッジケース、最適化を検討する。堅牢なソリューションを確保するために潜在的な強化を繰り返し検討する。
